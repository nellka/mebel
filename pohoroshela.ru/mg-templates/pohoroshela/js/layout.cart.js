$(document).ready(function(){function a(a){dataSmalCart+='<tr><td class="small-cart-img"><a href="'+mgBaseDir+"/"+(a.category_url?a.category_url:"catalog")+"/"+a.product_url+'"><img src="'+mgBaseDir+"/uploads/thumbs/30_"+(a.image_url?a.image_url:"no-img.jpg")+'" alt="'+a.title+'" alt="" /></a></td><td class="small-cart-name"><ul class="small-cart-list"><li><a href="'+mgBaseDir+"/"+(a.category_url?a.category_url:"catalog")+"/"+a.product_url+'">'+a.title+'</a><span class="property">'+a.property_html+'</span></li><li class="qty">x'+a.countInCart+" <span>"+a.priceInCart+'</span></li></ul></td><td class="small-cart-remove"><a href="#" class="deleteItemFromCart" title="\u0423\u0434\u0430\u043b\u0438\u0442\u044c" data-delete-item-id="'+a.id+'" data-property="'+a.property+'">&#215;</a></td></tr>'}$(".mg-close-popup").on("click",function(){$(this).parents(".mg-fake-cart").fadeOut("fast"),$(this).parents("body").find(".mg-layer").hide(),$("body").removeClass("mg-lock")}),$("body").on("click",".mg-layer",function(){$(".mg-layer").fadeOut("fast"),$(".mg-fake-cart").fadeOut("fast"),$("body").removeClass("mg-lock")}),$(".mg-desktop-cart").hover(function(a){a.stopPropagation(),$(".small-cart-table tbody tr").length>0&&$(".small-cart").addClass("show")},function(){$(".small-cart").removeClass("show")}),$("body").on("click",".addToCart",function(){var b=$(this).data("item-id");if(transferEffect(b,$(this),".product-wrapper"),$(this).parents(".property-form").length)var c=$(this).parents(".property-form").formSerialize();else var c="inCartProductId="+$(this).data("item-id")+"&amount_input=1";return $.ajax({type:"POST",url:mgBaseDir+"/cart",data:"updateCart=1&"+c,dataType:"json",cache:!1,success:function(b){$(".mg-layer").show(),$(".mg-fake-cart").fadeIn("fast"),$("body").addClass("mg-lock"),"success"==b.status&&(dataSmalCart="",b.data.dataCart.forEach(a),$(".small-cart-table").html(dataSmalCart),$(".total .total-sum span").text(b.data.cart_price_wc),$(".pricesht").text(b.data.cart_price),$(".countsht").text(b.data.cart_count))}}),!1}),$("body").on("click",".deleteItemFromCart",function(){var a=$(this),b=a.data("delete-item-id"),c=a.data("property"),d=a.data("variant");return $.ajax({type:"POST",url:mgBaseDir+"/cart",data:{action:"cart",delFromCart:1,itemId:b,property:c,variantId:d},dataType:"json",cache:!1,success:function(a){if("success"==a.status){var d=$('.deleteItemFromCart[data-property="'+c+'"][data-delete-item-id="'+b+'"]').parents("table");$('.deleteItemFromCart[data-property="'+c+'"][data-delete-item-id="'+b+'"]').parents("tr").remove();var e=1;d.find(".index").each(function(){$(this).text(e++)}),$(".total .total-sum span").text(a.data.cart_price_wc),a.data.cart_price=a.data.cart_price?a.data.cart_price:0,a.data.cart_count=a.data.cart_count?a.data.cart_count:0,$(".pricesht").text(a.data.cart_price),$(".countsht").text(a.data.cart_count),$(".cart-table .total-sum-cell strong").text(a.data.cart_price_wc),0==$(".small-cart-table tbody tr").length&&($(".mg-layer").hide(),$(".mg-fake-cart").hide(),$("body").removeClass("mg-lock"),$(".small-cart").hide(),$(".mg-desktop-cart .cart").css({border:"1px solid transparent"}),$(".mg-desktop-cart .cart-inner").css({background:"none"}),$(".empty-cart-block").show(),$(".product-cart").hide(),$(".cart-list .show-btn").hide())}}}),!1})});